<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ø³Ù„Ø© Ù…Ø´ØªØ±ÙŠØ§ØªÙƒ - Ø±Ø§Ø¬Ø¹ Ø·Ù„Ø¨Ùƒ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„">
    <meta name="theme-color" content="#f97316">
    <title id="pageTitle">Ø§Ù„Ø³Ù„Ø©</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/client-premium.css">
    <link rel="stylesheet" href="css/mobile.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ›’</text></svg>">
</head>
<body class="cp-page">
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">
                    <span class="logo-icon rocket-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="currentColor">
                           <path class="rocket-body" d="M12 2.5s-6 6.5-6 11c0 3 2.5 5.5 6 5.5s6-2.5 6-5.5c0-4.5-6-11-6-11z" fill="#E0E0E0"/>
                           <path class="rocket-window" d="M12 9a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5z" fill="#3B82F6"/>
                           <path class="rocket-fins" d="M5.5 14L2 19h5l1-2.5M18.5 14L22 19h-5l-1-2.5" fill="#FF5722"/>
                           <path class="rocket-fire" d="M12 20s-1.5 1.5-1.5 3 .5 1 1.5 1 1.5.5 1.5-1-1.5-3-1.5-3z" fill="#FFC107"/>
                        </svg>
                    </span>
                    <span id="logoName"></span>
                </a>
                
                <div class="header-actions">
                    <a href="index.html" class="cp-btn cp-btn-secondary" style="padding: 10px 20px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                        <span>Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Cart Page -->
    <main class="cp-main">
        <div class="cp-container">
            <!-- Page Title -->
            <h1 class="cp-page-title cp-fade-in">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
                Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨
            </h1>
            
            <!-- Empty Cart -->
            <div id="cartEmpty" style="display: none;">
                <div class="cp-card cp-empty cp-fade-in">
                    <div class="cp-empty-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
                    </div>
                    <h2 class="cp-empty-title">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</h2>
                    <p class="cp-empty-desc">Ù„Ù… ØªØ¶Ù Ø£ÙŠ ÙˆØ¬Ø¨Ø§Øª Ø¨Ø¹Ø¯. ØªØµÙØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙˆØ§Ø®ØªØ± ÙˆØ¬Ø¨Ø§ØªÙƒ Ø§Ù„Ù…ÙØ¶Ù„Ø©!</p>
                    <a href="index.html" class="cp-btn cp-btn-primary cp-btn-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                        ØªØµÙØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                    </a>
                </div>
            </div>
            
            <!-- Cart Content -->
            <div class="cart-content" style="display: none;">
                <div class="cp-grid">
                    <!-- Cart Items -->
                    <div class="cp-fade-in cp-delay-1">
                        <div class="cp-card" style="padding: 0; overflow: hidden;">
                            <div style="padding: 20px 24px; background: linear-gradient(180deg, #fafafa 0%, #fff 100%); border-bottom: 1px solid var(--cp-gray-100);">
                                <h3 style="margin: 0; font-size: 1.1rem; font-weight: 700; color: var(--cp-gray-800); display: flex; align-items: center; gap: 10px;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--cp-orange-500)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path></svg>
                                    Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ø³Ù„Ø©
                                </h3>
                            </div>
                            <div id="cartItems" style="padding: 20px;">
                                <!-- ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 20px;">
                            <a href="index.html" class="cp-btn cp-btn-secondary">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                                Ø£Ø¶Ù Ø§Ù„Ù…Ø²ÙŠØ¯
                            </a>
                            <button class="cp-btn cp-btn-danger" onclick="handleClearCart()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                                ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©
                            </button>
                        </div>
                    </div>
                    
                    <!-- Cart Summary -->
                    <div class="cp-fade-in cp-delay-2">
                        <div class="cp-summary">
                            <div class="cp-summary-header">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--cp-orange-500)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                                <h3>Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨</h3>
                            </div>
                            
                            <div class="cp-summary-row">
                                <span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ</span>
                                <span id="cartSubtotal" style="font-weight: 600;">0 Ø¯Ø¬</span>
                            </div>
                            <div class="cp-summary-row">
                                <span>Ø§Ù„ØªÙˆØµÙŠÙ„</span>
                                <span id="cartDelivery">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</span>
                            </div>
                            <div class="cp-summary-row total">
                                <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span>
                                <span id="cartTotal">0 Ø¯Ø¬</span>
                            </div>
                            
                            <a href="checkout.html" class="cp-btn cp-btn-primary cp-btn-lg cp-btn-block" id="checkoutBtn" style="margin-top: 20px;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>
                                Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="cp-footer">
        <div class="cp-container">
            <p>Â© 2026 Ù…Ø·Ø¹Ù…ÙŠ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="js/api-client.js"></script>
    <script src="js/data.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/app.js"></script>
    <script src="js/cart.js"></script>
    <script>

        document.addEventListener('DOMContentLoaded', async () => {
            // Render immediately
            renderCart();
            
            // Wait for settings
            if (typeof initializeData === 'function') {
                await initializeData();
                renderCart();
            }
            
            document.addEventListener('data-ready', renderCart);
        });
        
        function renderCart() {
            const cart = getCart();
            const cartEmpty = document.getElementById('cartEmpty');
            const cartContent = document.querySelector('.cart-content');
            const cartItems = document.getElementById('cartItems');
            
            if (cart.length === 0) {
                cartEmpty.style.display = 'block';
                if(cartContent) cartContent.style.display = 'none';
                return;
            }
            
            cartEmpty.style.display = 'none';
            if(cartContent) cartContent.style.display = 'block';
            
            cartItems.innerHTML = cart.map((item, index) => {
                // Ensure unique ID for quantity input
                const uniqueId = `${item.id}-${item.sizeId || 'default'}`;
                
                return `
                <div class="cp-cart-item cp-fade-in" style="animation-delay: ${Math.min(index * 0.05, 0.5)}s;">
                    <div class="cp-cart-item-image">
                        ${window.getMealImageOrPlaceholder 
                            ? window.getMealImageOrPlaceholder(item, 'width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: var(--cp-gray-100);', 'width: 100%; height: 100%; object-fit: cover;') 
                            : `<img src="${item.image || 'images/placeholder.png'}" alt="${item.name}" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ½ï¸</text></svg>'">`
                        }
                    </div>
                    <div class="cp-cart-item-info">
                        <div class="cp-cart-item-name">${item.name}</div>
                        ${item.sizeName ? `<div class="cp-cart-item-size">${item.sizeName}</div>` : ''}
                        <div class="cp-cart-item-price">${formatPrice(item.price * item.quantity)}</div>
                    </div>
                    
                    <div class="cp-cart-item-actions">
                        <!-- Quantity Control -->
                        <div class="cp-qty-control">
                            <button class="cp-qty-btn minus" 
                                onclick="updateCartQuantity('${item.id}', ${item.quantity - 1})"
                                ${item.quantity <= 1 ? 'disabled style="opacity:0.3; cursor:not-allowed;"' : ''}
                            >âˆ’</button>
                            
                            <span class="cp-qty-value">${item.quantity}</span>
                            
                            <button class="cp-qty-btn plus" 
                                onclick="updateCartQuantity('${item.id}', ${item.quantity + 1})">+</button>
                        </div>
                        
                        <!-- Delete Button -->
                        <button class="cp-remove-btn" onclick="removeItemWithConfirm('${item.id}', '${item.sizeId || ''}')" title="Ø­Ø°Ù Ø§Ù„ÙˆØ¬Ø¨Ø©">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2-2v2"></path></svg>
                        </button>
                    </div>
                </div>
            `}).join('');
            
            updateCartSummary();
        }
        
        function updateItemQuantity(mealId, sizeId, newQuantity) {
            // Prevent going below 1 via minus button (user must use delete button)
            if (newQuantity < 1) return;
            
            // The arguments are confusingly named in the HTML onclick, but mealId holds the item.id
            // updateCartQuantity in cart.js takes (itemId, newQuantity)
            updateCartQuantity(mealId, newQuantity);
            renderCart();
        }
        
        async function removeItemWithConfirm(mealId, sizeId) {
            if (await confirmAction('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ¬Ø¨Ø© Ù…Ù† Ø§Ù„Ø³Ù„Ø©ØŸ')) {
                removeFromCart(mealId, sizeId);
                renderCart();
            }
        }
        
        // Helper wrappers
        function updateCartSummary() {
            const subtotal = getCartTotal();
            const settings = getSettings();
            let deliveryText = 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            let deliveryCost = 0;
            
            if (settings?.delivery?.enabled) {
                if (settings.delivery.type === 'fixed') {
                    deliveryCost = settings.delivery.fixedCost || 0;
                    deliveryText = deliveryCost === 0 ? 'Ù…Ø¬Ø§Ù†ÙŠ' : formatPrice(deliveryCost);
                } else if (settings.delivery.type === 'free') {
                    deliveryText = 'Ù…Ø¬Ø§Ù†ÙŠ';
                }
            }
            
            document.getElementById('cartSubtotal').textContent = formatPrice(subtotal);
            document.getElementById('cartDelivery').textContent = deliveryText;
            document.getElementById('cartTotal').textContent = formatPrice(subtotal + deliveryCost);
        }
        
        async function handleClearCart() {
            if (await confirmAction('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ')) {
                clearCart();
                renderCart();
            }
        }
    </script>
    

</body>
</html>
